<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoteLedger - Ongoing Voting</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="style.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .hero-box {
            background: #222;
            border-radius: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.10);
            padding: 2.5rem 1.5rem 2rem 1.5rem;
            margin: 2rem auto 2.5rem auto;
            max-width: 80vw;
            width: 80vw;
            text-align: center;
        }
        .hero-title {
            font-family: 'Fira Mono', 'Consolas', 'Courier New', monospace;
            font-size: 2.2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        .hero-subtitle {
            color: #bbb;
            font-size: 1.1rem;
            margin-bottom: 1.5rem;
        }
        .btn-create-voting {
            font-weight: bold;
            font-size: 1.1rem;
            padding: 0.7rem 2.2rem;
        }
        .navbar .btn-connect-wallet {
            margin-left: 1rem;
        }
    </style>
</head>
<body class="bg-black">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-black ">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-vote-yea me-2"></i>VoteLedger
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <div class="ms-auto">
                    <button class="btn btn-warning btn-connect-wallet" id="connectWalletBtn">Connect Wallet</button>
                </div>
            </div>
        </div>
    </nav>
    <div class="navbar-separator"></div>

    <div class="container" >
        <div class="hero-box">
            <div class="hero-title mb-2">Welcome to VoteLedger</div>
            <div class="hero-subtitle mb-3">Initiate and engage in secure, decentralized voting powered by blockchain technology.
                .</div>
            <a href="voting.html" class="btn btn-warning btn-create-voting">Create New Voting</a>
        </div>
    </div>

    <div class="container ongoing-voting-section mt-4" style="margin-bottom: 3.5rem;">
        <h2 class="ongoing-voting-title text-center">Ongoing Voting Sessions</h2>
        <div id="ongoingVotingContent" class="row justify-content-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading...</span>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer-separator"></div>
    <footer class="bg-black text-light pt-5 pb-4">
        <div class="container text-md-left">
          <div class="row text-md-left">
              <!-- Company Info -->
              <div class="col-md-4 col-lg-4 col-xl-4 mx-auto mt-3">
                <h5 class="text-uppercase text-warning mb-4 font-weight-bold">VoteLedger</h5>
                <p >
                  Your voice matters. VoteLeder empowers digital democracy through secure, easy-to-use voting technology.
                </p>
              </div>
              <!-- Useful Links -->
              <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
                <h5 class="text-uppercase text-warning mb-4">Quick Links</h5>
                <p><a href="index.html" class="text-light text-decoration-none">Home</a></p>
                <p><a href="login.html" class="text-light text-decoration-none">Login</a></p>
                <p><a href="vote.html" class="text-light text-decoration-none">Vote Now</a></p>
                <p><a href="tel:+919876543210" class="text-light text-decoration-none">Contact</a></p>
              </div>
              <!-- Contact Info -->
              <div class="col-md-4 col-lg-4 col-xl-4 mx-auto mt-3">
                <h5 class="text-uppercase text-warning mb-4">Contact</h5>
                <p class="text-light"><i class="bi bi-envelope me-2"></i> ak9754886@gmail.com</p>
                <p class="text-light"><i class="bi bi-telephone me-2"></i> +91 9873134920</p>
                <p class="text-light"><i class="bi bi-geo-alt me-2"></i> Delhi, India</p>
              </div>
          </div>
          <hr class="text-white my-4">
          <!-- Social & Copyright -->
          <div class="row align-items-center ">
            <div class="col-md-7 col-lg-8">
              <p class="text-muted mb-0">Â© 2025 VoteLedger. All rights reserved.</p>
            </div>
            <div class="col-md-5 col-lg-4 text-md-end">
              <a href="#" class="text-muted me-3"><i class="https://x.com/Anupam_3792"></i></a>
              <a href="#" class="text-muted me-3"><i class="https://github.com/Anupam3792"></i></a>
              <a href="#" class="text-muted me-3"><i class="bi bi-instagram fs-5"></i></a>
              <a href="#" class="text-muted"><i class="https://www.linkedin.com/in/anupam-kumar-4b6b94261?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=android_app"></i></a>
            </div>
          </div>
        </div>
      </footer>

    <!-- Bootstrap Icons CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Web3.js -->
    <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
    <!-- ethers.js -->
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <!-- Custom JS -->
    <script src="app.js"></script>
    <script>
    function shortAddress(addr) {
        return addr ? addr.slice(0, 6) + '...' + addr.slice(-4) : '';
    }
    document.getElementById('connectWalletBtn').onclick = async function() {
        if (window.ethereum) {
            try {
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                const shortAddr = shortAddress(accounts[0]);
                this.textContent = shortAddr;
                this.classList.remove('btn-warning');
                this.classList.add('btn-success');
                this.disabled = false;
            } catch (e) {
                alert('Wallet connection failed.');
            }
        } else {
            alert('MetaMask not found!');
        }
    };
    document.addEventListener('DOMContentLoaded', async function() {
        const content = document.getElementById('ongoingVotingContent');
        try {
            const sessions = await getOngoingVotings();
            const now = Math.floor(Date.now() / 1000);
            if (sessions.length > 0) {
                let html = '';
                for (const session of sessions) {
                    const startDate = new Date((session.endDate - 7 * 24 * 60 * 60) * 1000); // Placeholder: adjust if you have real startDate
                    const endDate = new Date(session.endDate * 1000);
                    const isOngoing = session.endDate > now;
                    html += `
                        <div class='card bg-dark text-light h-100 shadow voting-card'>
                            <div class='card-body'>
                                <h5 class='card-title text-warning'>Session: ${session.id}</h5>
                                <p class='card-text mb-2'><strong>Start:</strong> <span class='text-info'>${startDate.toLocaleString()}</span></p>
                                <p class='card-text mb-2'><strong>Ends:</strong> <span class='text-info'>${endDate.toLocaleString()}</span></p>
                                <a href="${isOngoing ? `vote.html?session=${encodeURIComponent(session.id)}` : `result.html?session=${encodeURIComponent(session.id)}`}" class='btn btn-${isOngoing ? "primary" : "secondary"} w-100'>${isOngoing ? "Vote Now" : "View Result"}</a>
                            </div>
                        </div>
                    `;
                }
                content.innerHTML = html;
            } else {
                content.innerHTML = `<div class='alert alert-info'>No ongoing voting sessions at the moment.</div>`;
            }
        } catch (e) {
            content.innerHTML = `<div class='alert alert-danger'>Failed to load voting info.</div>`;
        }
    });
    </script>
</body>
</html> 